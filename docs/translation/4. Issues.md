# Translation Issues

There are some cases with _gotchas_ when translating. If you are having issues, check if your problem is solved below.


## Dynamic Templating Translation

Since we are using templating, we might not be able to pull a specific value for translation. For example, consider:

    <p translate> {{ item.FloorplanStatusName }} </p>

In this case, the extractor will pull out the text as it is, but it will mean nothing to the translators. For this, we won't need them to translate this text, but we still apply it because we know the values will return a specific set of results, therefor getting translated correctly.

In some cases this string might already be translated -- e.g. if it came from the API translated -- so we won't need to translate again.


## HTML in Translation Strings

There will be some cases where HTML will have to be included in the translation string. We try to minimize it as much as possible, but simple formatting may slip in. For example, it's ok to have the following:

    <p translate>Hello <strong>{{ name }}</strong></p>

which the translator will see as `Hello <strong>{{ name }}</strong>`. However, if the HTML does not need to be included, leave it off. For example, in the following case:

    // Bad
    <button translate>Download <span class="icon-download"></span></button>

should be using the following code instead:

    // Good
    <button><span translate>Download</span> <span class="icon-download"></span></button>

Although it is more verbose, it only translates the string which is what we need. The icon doesn't need to be included. This will also prevent having duplicate translations for the same string -- e.g. "Download" and "Download <span class="icon-download"></span>".


## Strings passed into Attributes

When passing strings into attributes or directives, we need to use the filter. If we try to translate inside of the directive, we won't have that string properly extracted during `grunt translate`. Translating with an attribute will be done by filter:

    <div nxg-tooltip="{{ 'Find out more info' | translate }}">


## Duplicate translations

Sometimes when the translations come back from the translators, we have duplicate translations. This can be caused a few different ways:

### Singular and Plural definitions

Singular and Plural versions of strings are stored in different ways in the `po` files. In some cases we use the singular version in one place, and a plural in another, then at another place we switch based on count. This can cause problems because gettext sees we have duplicate "keys" for the singular version since the singular and plural versions use the same key but have different definitions. To prevent this, we need to convert singular items with plural translations to use the plural lookup instead. This would be done like so:

    <p translate translate-n="1" translate-plural="Account Fees">Account Fee</p>

You can see even though we want the text _"Account Fee"_, we force showing the singular version by passing `translate-n="1"`. If you want to force the plural version, you would use `translate-n="2"` instead.

### Multiple definitions

When the translators send back the translations, sometimes it is broken into multiple lines, and sometimes it is not. This causes duplicate translations because the `grunt translate_missing` cannot properly match up 1:1. This is currently a bug in the task itself can could be modified to fix this problem, but for the time being please be aware. Here is an example of the two versions for same translation:

    #: Broken version
    #: app/views/modals/paymentOptionsBreakdown.html
    msgid ""
    "Payout Amount must be $0.01 to {{ maxAdditional | "
    "currency }}"
    msgstr ""
    "Le montant du paiement doit se situer entre 0,01 $ et {{ maxAdditional | "
    "currency }}"
    
    #: Fixed version
    #: app/views/modals/paymentOptionsBreakdown.html
    msgid "Payout Amount must be $0.01 to {{ maxAdditional | currency }}"
    msgstr ""
    "Le montant du paiement doit se situer entre 0,01 $ et {{ maxAdditional | "
    "currency }}"

You can notice the difference in the `msgid` string. The broken one starts on the second line and wraps at a weird point. The fixed one does not. You will notice this problem if the translated string is included in your translated files, but you keep getting it in your untranslated files. This is because of the wrapping. To fix it, we generally copy the untranslated `msgid` line from the untranslated file, and find the correct matching translation, and overwrite the `msgid`. Re-run the tasks and this should fix it.