<div class="container">
  <section class="row">
    <section class="col-xs-12">
      <div class="panel panel-default" ng-if="audits.results.length === 0 && !audits.loading">
        <h2 class="well-title" translate>
          <span translate>Open Audits</span>
        </h2>
        <div class="panel-body" translate>
          <p>
            You currently have no open audits.
          </p>
          <hr>
          <p>
            <a href="#/home">Click here</a> to return to your dashboard.
          </p>
        </div>
      </div>
      <div ng-if="audits.results.length > 0 || audits.loading">
        <div class="panel panel-default"
             ng-repeat="(method, results) in audits.groupedResults | orderBy:method track by method"
             nxg-infinite-scroll-show-indicator="audits.loading">
          <h2 class="well-title" translate>
            <span translate>Resolve via {{ method }}</span>
          </h2>
          <div class="panel-body" translate>
            <table class="table table-striped table-primary">
              <thead>
                <th class="sortable hidden-xs"
                    ng-click="audits.sortBy('flooringDate')"
                    ng-class="{ sorted : audits.sortField == 'flooringDate', desc : audits.sortDescending }">
                  <nxg-sortable sortable-text="{{ 'Floored' | translate }}"></nxg-sortable>
                </th>
                <th class="sortable hidden-xs"
                    ng-click="audits.sortBy('unitInspectionDateTime')"
                    ng-class="{ sorted : audits.sortField == 'unitInspectionDateTime', desc : audits.sortDescending }">
                  <nxg-sortable sortable-text="{{ 'Audited' | translate }}"></nxg-sortable>
                </th>
                <th class="sortable hidden-xs"
                    ng-click="audits.sortBy('stockNumber')"
                    ng-class="{ sorted : audits.sortField == 'stockNumber', desc : audits.sortDescending }">
                  <nxg-sortable sortable-text="{{ 'Stock #' | translate }}"></nxg-sortable>
                </th>
                <th class="sortable hidden-xs"
                    ng-click="audits.sortBy('unitMake')"
                    ng-class="{ sorted : audits.sortField == 'unitMake', desc : audits.sortDescending }">
                  <nxg-sortable sortable-text="{{ 'Description' | translate }}"></nxg-sortable>
                </th>
                <th class="sortable hidden-xs"
                    ng-click="audits.sortBy('unitVin')"
                    ng-class="{ sorted : audits.sortField == 'unitVin', desc : audits.sortDescending }">
                  <nxg-sortable sortable-text="{{ 'VIN' | translate }}"></nxg-sortable>
                </th>
                <th class="sortable hidden-xs"
                    ng-click="audits.sortBy('unitStatusCode')"
                    ng-class="{ sorted : audits.sortField == 'unitStatusCode', desc : audits.sortDescending }">
                  <nxg-sortable sortable-text="{{ 'Status' | translate }}"></nxg-sortable>
                </th>
              </thead>
              <tbody>
                <tr ng-repeat="item in results | orderBy:audits.sortField:audits.sortDescending">
                  <td class="hidden-xs">
                    <p class="lockup-major"> {{ item.flooringDate | moment }} </p>
                    <p class="lockup-minor" translate>{{ item.daysOnFloorplan }} days</p>
                  </td>
                  <td class="hidden-xs">
                    <p class="lockup-major"> {{ item.inspectionDateTime | moment }} </p>
                    <p class="lockup-minor" translate>{{ item.vehicleStatusDays }} days</p>
                  </td>
                  <td class="hidden-xs">
                    <p class="lockup-major"> {{ item.stockNumber }} </p>
                  </td>
                  <td class="description-narrow">
                    <a class="lockup-major" href="#/vehicledetails?stockNumber={{ item.stockNumber }}">
                      <span nxg-highlight="item.Description" highlight="item.data.query" class="break-word"></span>
                    </a>

                    <!--mobile view-->
                    <p class="lockup-minor">{{ item.unitYear }} {{ item.unitMake }} {{ item.unitModel }}</p>
                    <div class="visible-xs">
                      <p class="lockup-minor">VIN: {{ item.unitVin }}</p>
                      <p class="lockup-minor">Stock #: {{ item.stockNumber }}</p>
                      <p class="vertical-spacing" id="floored">
                        <span translate>Floored: </span>
                        <strong>{{ item.flooringDate | moment }}</strong>
                        ({{ item.daysOnFloorplan }} <span translate>days</span>)
                      </p>
                      <p class="vertical-spacing"><span translate>Audited: </span> <strong>{{ item.inspectionDateTime
                        | moment
                        }}</strong>
                        ({{ item.vehicleStatusDays }} <span translate>days</span>) {{ item.unitStatusCode }}</p>
                    </div>
                    <!--end mobile view-->
                  </td>
                  <td class="hidden-xs">
                    <p> {{ item.unitVin }} </p>
                  </td>
                  <td class="hidden-xs">
                    <p> {{ item.unitStatusCode }} </p>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </section>
</div>
