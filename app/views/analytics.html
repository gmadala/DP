<div class="container-line">
  <div class="container-fluid nxg-analytics">
    <section class="row-fluid business-summary {{ showDetails && 'expanded' || 'collapsed'}}">
      <div class="span12 well">
        <h2 class="well-title">Business Summary</h2>

        <div class="row-fluid">
          <div class="span5 well-item">
            <h3>Approved Floor Plans</h3>
            <span class="counter"> {{ businessSummary.ApprovedFloorplans }} </span> Approved

            <ul class="list-table">
              <li class="list-table-row">
                <p class="span8">Total NextGear Capital Book Value:</p>
                <p class="span4 value numeric">{{ businessSummary.TotalApprovedBlackBookValue | currency }} </p>
              </li>
              <li class="list-table-row">
                <p class="span8"> Total Financed Amount: </p>
                <p class="span4 value numeric"> {{ businessSummary.TotalApprovedFinancedAmount| currency }} </p>
              </li>
              <li class="list-table-row">
                <p class="span8"> Total Outstanding: </p>
                <p class="span4 value numeric"> {{ businessSummary.TotalOutstandingPrincipal | currency }} </p>
              </li>
              <li class="list-table-row" ng-show="showDetails">
                <p class="span8"> Average Purchase Price: </p>
                <p class="span4 value numeric"> {{ businessSummary.AveragePurchasePrice | currency }} </p>
              </li>
              <li class="list-table-row" ng-show="showDetails">
                <p class="span8"> Total Purchase Price: </p>
                <p class="span4 value numeric">  {{ businessSummary.TotalApprovedPurchasePrice | currency }} </p>
              </li>
            </ul>

            <p ng-show="showDetails">
              NextGear Capital Book is {{ businessSummary.DerivedCapitalBook | number:2 }}% of the Purchase Price
            </p>
            <p ng-show="showDetails">
              Amount Outstanding is {{ businessSummary.DerivedAmountOutstanding | number:2 }}% of the NextGear Capital Book
            </p>

            <button ng-click="toggleDetails()" class="btn" nxg-track="{{showDetails && metric.CLICK_VIEW_ANALYTICS_SHOW_DETAILS_LINK || ''}}">
              {{ showDetails && 'Close' || 'Show'}} Details
            </button>
          </div>

          <div class="span4 well-item">
            <h3>Pending Floor Plans</h3>
            <span class="counter"> {{ businessSummary.PendingFloorplans }} </span> Pending

            <ul class="list-table">
              <li class="list-table-row">
                <p class="span8"> Total Purchase Price: </p>
                <p class="span4 value numeric"> {{ businessSummary.TotalPendingPurchasePrice | currency }} </p>
              </li>
              <li class="list-table-row">
                <p class="span8"> Total NextGear Capital Book Value: </p>
                <p class="span4 value numeric"> {{ businessSummary.TotalPendingBlackBookPrice | currency }} </p>
              </li>
            </ul>

            <p ng-show="showDetails">
              NextGear Capital Book is {{ businessSummary.DerivedPendingBook | number:2 }}% of the Purchase Price.
            </p>
          </div>

          <div class="span3 well-item">
            <h3>Credits and Payments</h3>

            <ul class="list-table">
              <li class="list-table-row">
                <p class="span8"> Available Credit: </p>
                <p class="span4 value numeric"> {{ businessSummary.TotalAvailableCredit | currency }}</p>
              </li>
              <li class="list-table-row">
                <p class="span8"> Reserve Funds: </p>
                <p class="span4 value numeric"> {{ businessSummary.ReserveFundsBalance | currency }}</p>
              </li>
              <li class="list-table-row">
                <p class="span8"> Last Payment: </p>
                <p class="span4 value numeric"> {{ businessSummary.LastPaymentAmount | currency }}</p>
              </li>
              <li class="list-table-row">
                <p class="span8"> Last Payment Date: </p>
                <p class="span4 value numeric"> {{ businessSummary.LastPaymentDate | moment }}</p>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section class="row-fluid">
      <div class="span9 well average-turn-chart">
        <h2 class="well-title">Average Turn</h2>

        <div class="well-item">
          <div class="chart-obj"
              nxg-chart
              nxg-chart-type="line"
              nxg-chart-data-name="Days to Turn"
              nxg-chart-description-x="Average # of Days to Turn"
              nxg-chart-data="analytics.averageTurn.data"
              nxg-chart-labels="true">
          </div>
        </div>
      </div>

      <div class="span3 well aging-vehicles">
        <h2 class="well-title">Stale & Aging Vehicles</h2>

        <div class="well-item">
          <ul class="list-table">
            <li class="list-table-row">
              <p class="span4">
                <span class="counter overdue">{{ analytics.aging[4] }}</span>
              </p>
              <p class="span8 numeric counter-label">
                <strong>100+</strong> Days
              </p>
            </li>
            <li class="list-table-row">
              <p class="span4">
                <span class="counter">{{ analytics.aging[3] }}</span>
              </p>
              <p class="span8 numeric counter-label">
                <strong>75-99</strong> Days
              </p>
            </li>
            <li class="list-table-row">
              <p class="span4">
                <span class="counter">{{ analytics.aging[2] }}</span>
              </p>
              <p class="span8 numeric counter-label">
                <strong>50-74</strong> Days
              </p>
            </li>
            <li class="list-table-row">
              <p class="span4">
                <span class="counter">{{ analytics.aging[1] }}</span>
              </p>
              <p class="span8 numeric counter-label">
                <strong>25-49</strong> Days
              </p>
            </li>
            <li class="list-table-row">
              <p class="span4">
                <span class="counter">{{ analytics.aging[0] }}</span>
              </p>
              <p class="span8 numeric counter-label">
                <strong>1-24</strong> Days
              </p>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <section class="row-fluid">
      <div class="span6 well movers-container">
        <h2 class="well-title">Best and Worst Movers by Zipcode</h2>
        <div class="well-item">

          <div class="cta btn-toggle">
            <div class="btn-slider" ng-class="{ 'active-left':showBest(), 'active-right':!showBest() }"></div>
            <button class="btn" ng-click="changeMoverChart('best')">Best Movers</button>
            <button class="btn" ng-click="changeMoverChart('worst')">Worst Movers</button>
          </div>

          <table class="movers-list">
            <tr ng-repeat="model in selectedMoverChart.labels">
              <td class="rank">
                {{ $index + 1 }}
              </td>
              <td class="models">
                <div>
                  <span>({{ model.year }})</span>
                  <span>{{ model.make }}</span>
                </div>
                <div>{{ model.model }}</div>
              </td>
            </tr>
          </table>

          <div class="movers-chart">
            <div>
              <div class="chart-obj"
                   nxg-chart
                   nxg-chart-type="bar"
                   nxg-chart-data-name="Days to Turn"
                   nxg-chart-description-x="Avg. # of Days to Turn"
                   nxg-chart-data="selectedMoverChart.data"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="span6 well top-auctions-container">
        <h2 class="well-title">Your Top 10 Auctions</h2>
        <p>Number of Cars Purchased Per-Auction (in the last 12 months)</p>

        <button href class="btn" ng-click="openTopAuctions()" nxg-track="{{metric.CLICK_VIEW_ANALYTICS_VIEW_ALL_AUCTIONS_BUTTON}}">
          <span nxg-icon="icon-eye"></span>
          View All Auctions
        </button>
        <div class="auctions-chart">
          <div class="chart-obj"
               nxg-chart
               nxg-chart-type="bar"
               nxg-chart-data-name="# Purchased"
               nxg-chart-description-x="# of Cars Purchased"
               nxg-chart-data="analytics.top10Auctions"
               nxg-chart-labels="true"
               nxg-chart-trim-labels="true">
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
