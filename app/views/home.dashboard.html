<section class="row-fluid upcoming">
  <div class="row-fluid">
    <!-- Calendar -->
    <div class="span9 nxg-dash-calendar-container well" >
      <h2 class="well-title">Upcoming Payments</h2>
      <div class="nxg-dash-calendar-header">
        <div class="nxg-fancy-radios">
          <input type="radio" class="first" name="{{ 'h-' + viewMode }}" id="week" value="week" ng-model="viewMode" placeholder="This Week">
          <label class="pointer" for="week" id="week-label"></label>
          <input type="radio" class="last" name="{{ 'h-' + viewMode }}" id="month" value="month" ng-model="viewMode" placeholder="This Month">
          <label class="pointer" for="month" id="month-label"></label>
        </div>
      </div>

      <div nxg-upcoming-calendar display="viewMode" data="dashboardData.calendarData"></div>

      <div class="nxg-dash-calendar-header fc bottom" ng-show="viewMode == 'month'">
        <div class="nxg-fancy-radios">
          <input type="radio" class="first" name="{{ 'f-' + viewMode }}" id="f-week" value="week" ng-model="viewMode" placeholder="This Week">
          <label class="pointer" for="f-week" id="week-label"></label>
          <input type="radio" class="last" name="{{ 'f-' + viewMode }}" id="f-month" value="month" ng-model="viewMode" placeholder="This Month">
          <label class="pointer" for="f-month" id="month-label"></label>
        </div>

        <!-- To add footer controls -->
        <table class="fc-header" style="width:100%">
          <tbody>
            <tr>
              <td class="fc-header-left">
                <span class="fc-button fc-button-prev fc-state-default fc-corner-left fc-corner-right" ng-class="{ 'fc-state-disabled': isPast() }" unselectable="on" ng-click="onClickPrev()">
                  <span class="fc-text-arrow">‹</span>
                </span>
                <span class="fc-header-space"></span>
                <span class="fc-button fc-button-today fc-state-default fc-corner-left fc-corner-right" ng-class="{ 'fc-state-disabled': isPast() }" ng-click="onClickToday()" unselectable="on">today</span>
              </td>
              <td class="fc-header-center"></td>
              <td class="fc-header-right">
                <span class="fc-button fc-button-next fc-state-default fc-corner-left fc-corner-right" unselectable="on" ng-click="onClickNext()">
                  <span class="fc-text-arrow">›</span>
                </span>
              </td>
            </tr>
          </tbody>
        </table>
        <!-- end footer controls -->
      </div>
    </div>

    <!-- Payment Summary -->
    <div class="span3 well payment-summary">
      <h2 class="well-title">Payments Summary</h2>
      <ul>
        <li class="link" ng-click="filterPayments('overdue')" nxg-track="{{metric.CLICK_DASHBOARD_PAYMENTS_OVERDUE}}">
          <span class="counter" ng-class="{overdue: dashboardData.OverduePayments > 0}">{{dashboardData.OverduePayments}}</span>
          <div class="dash-lockup">
            <p class="dash-minor" ng-pluralize
                count="dashboardData.OverduePayments"
                when="{'1': 'Overdue', 'other': 'Overdue'}"></p>
            <h4 class="dash-major" ng-class="{'overdue-amount': dashboardData.OverduePaymentAmount > 0}">{{dashboardData.OverduePaymentAmount | currency}}</h4>
          </div>
        </li>
        <li class="link" ng-click="filterPayments('today')" nxg-track="{{metric.CLICK_DASHBOARD_PAYMENTS_DUE_TODAY}}">
          <span class="counter" ng-class="{'due-today': dashboardData.PaymentsDueToday > 0}">{{dashboardData.PaymentsDueToday}}</span>
          <div class="dash-lockup">
            <p class="dash-minor" ng-pluralize
                count="dashboardData.PaymentsDueToday"
                when="{'1': 'Due Today', 'other': 'Due Today'}"></p>
            <h4 class="dash-major">{{dashboardData.PaymentsDueTodayAmount | currency}}</h4>
          </div>
        </li>
        <li class="link" ng-click="filterPayments('this-week')" nxg-track="{{metric.CLICK_DASHBOARD_PAYMENTS_WEEK}}">
          <span class="counter">{{dashboardData.UpcomingPayments}}</span>

          <div class="dash-lockup">
            <span class="lockup-minor" ng-pluralize
                  count="dashboardData.UpcomingPayments"
                  when="{'1': 'Payment', 'other': 'Payments'}"></span>
            <span>This {{ viewMode | capitalize }}</span>
            <h4 class="dash-major">{{dashboardData.UpcomingPaymentsAmount | currency}}</h4>
          </div>
        </li>
        <li class="link" ng-click="filterPayments()" nxg-track="{{metric.CLICK_DASHBOARD_PAYMENTS_FEES}}">
          <span class="counter">{{dashboardData.AccountFees}}</span>
          <div class="dash-lockup">
            <p class="dash-minor" ng-pluralize
               count="dashboardData.AccountFees"
               when="{'1': 'Account Fee', 'other': 'Account Fees'}"></p>
            <h4 class="dash-major">{{dashboardData.AccountFeeAmount | currency}}</h4>
          </div>
        </li>
              </ul>
        <button class="btn-cta cta-full cta-primary" href="#/home/payments" nxg-track="{{metric.CLICK_DASHBOARD_PAYMENTS_VIEW_ALL_PAYMENTS_BUTTON}}">
          <span class="paired-body">View All Payments</span>
          <span class="paired-media" nxg-icon="icon-eye"></span>
        </button>

    </div>
  </div>

  <!-- More Details -->
  <div collapse="isCollapsed" ng-init="isCollapsed = true" ng-class="{ open: !isCollapsed }" class="row-fluid dashboard-more-details">
    <!-- Upcoming Payments -->
    <div class="span9 well upcoming-payments">
      <p>Upcoming Payments</p>
      <div class="upcoming-payments-table">
        <table>
          <thead>
            <tr>
              <th>Due Date</th>
              <th>Description</th>
              <th>Payoff Due</th>
              <th>Payment Due</th>
            </tr>
          </thead>
          <tr ng-repeat="payment in dashboardData.UpcomingPaymentsList">
            <td title="Due Date" class="pay-due-date">{{ payment.DueDate | moment  }}
              <div class="nxg-payment-due-status"
                 ng-class="getDueStatus(payment)"
                 ng-switch="getDueStatus(payment)">
                <p class="warning today" ng-switch-when="today"><span class="excl-today">!</span>Due Today</p>
                <p class="warning overdue" ng-switch-when="overdue"><span class="excl-overdue">!</span>Overdue</p>
              </div>

            </td>
            <td title="Description">{{ payment.Description }}</td>
            <td title="Payoff Due">
              <span>{{ payment.PayoffDue | currency }}</span>
            </td>
            <td title="Payment Due">
              <span>{{ payment.PaymentDue | currency }}</span>
            </td>
          </tr>
        </table>
        <a class="more btn btn-mini" tabindex="{{{true: '-1', false: ''}[isCollapsed]}}" href="#/home/payments"> <i class="glyphicon glyphicon-eye-open"></i>
          View All Payments
        </a>
      </div>
    </div>

    <!-- Payments Chart -->
    <div class="span3 payments-chart">
      <div class="chart-obj"
          nxg-chart
          nxg-chart-type="pie"
          nxg-chart-tooltip="false"
          nxg-chart-size="chartOptions.size"
          nxg-chart-data="dashboardData.paymentChartData.chartData"
          nxg-donut-options="chartOptions.donutOptions">
      </div>
      <label class="nxg-doughnut-chart-label"  style="z-index:1000" ng-class="{smaller: tooLong(dashboardData.paymentChartData.total, '$0[.]00a')}">
        <p class="nxg-doughnut-chart-label-primary">{{ dashboardData.paymentChartData.total | numeral:'($0[.]00a)' }}</p>
        <p class="nxg-doughnut-chart-label-secondary">Total</p>
      </label>

      <table class="chart-summary-table">
        <tr>
          <td> <i class="nxg-chart-legend-color nxg-chart-fees"></i>
          </td>
          <td class="no-bold">Fees</td>
          <td>{{ dashboardData.paymentChartData.fees | currency }}</td>
        </tr>
        <tr>
          <td>
            <i class="nxg-chart-legend-color nxg-chart-payments"></i>
          </td>
          <td class="no-bold">Payments</td>
          <td>{{ dashboardData.paymentChartData.payments | currency }}</td>
        </tr>
        <tr class="chart-summary-table-total-row">
          <td>
            <i class="nxg-chart-legend-color nxg-chart-scheduled-payments"></i>
          </td>
          <td class="no-bold">Scheduled</td>
          <td>
            {{ dashboardData.paymentChartData.scheduledPayments | currency }}
          </td>
        </tr>
        <tr>
          <td class="taller" colspan="2">Total for this {{ viewMode }}:</td>
          <td class="taller">{{ dashboardData.paymentChartData.total | currency }}</td>
        </tr>
      </table>
    </div><!-- end .payments-chart -->
  </div><!-- end .dashboard-more-details -->

  <div class="details-toggle" ng-class="{ open: !isCollapsed }">
    <div class="details-toggle-line">
      <button ng-click="isCollapsed = !isCollapsed" class="details-toggle-btn">
        <i class="glyphicon glyphicon-chevron-{{ isCollapsed && 'down' || 'up'}}"></i>
        {{ isCollapsed && 'Show' || 'Close'}} Details</button>
    </div>
  </div>
</section>

<section class="row-fluid">
  <!-- Credit Summary -->
  <div class="span5 well">
    <h2 class="well-title">Credit Information</h2>
    <div class="row-fluid credit-chart clearfix">
      <div class="span5 donut-nested">
          <div class="donut-outer"
                nxg-chart
                nxg-chart-type="pie"
                nxg-chart-tooltip="false"
                nxg-chart-size="chartOptions.size"
                nxg-chart-data="chartData.credit.outer"
                nxg-donut-options="chartOptions.donutOptions"
                nxg-chart-title="chartData.creditTitle"></div>
          <div class="donut-inner"
                nxg-chart
                nxg-chart-type="pie"
                nxg-chart-tooltip="false"
                nxg-chart-size="chartOptions.innerSize"
                nxg-chart-data="chartData.credit.inner"
                nxg-donut-options="chartOptions.donutOptions"></div>
      </div>

      <div class="span7">
        <div class="style-select space">
          <select></select>
        </div>

        <table class="table table-unstyle chart-legend">
          <tr>
            <td></td>
            <td class="table-label">Total Credit</td>
            <td class="table-symbol">=</td>
            <td class="table-value table-numeric">
              {{ dashboardData.LineOfCredit + dashboardData.TempLineOfCredit | numeral:'$0,0.00' }}
            </td>
          </tr>
          <tr>
            <td>
              <i class="chart-legend-color nxg-chart-utilized-credit"></i>
            </td>
            <td class="table-label">Utilized Credit</td>
            <td class="table-symbol color-danger">–</td>
            <td class="table-value table-numeric">{{ dashboardData.UtilizedCredit | numeral:'$0,0.00' }}</td>
          </tr>
          <tr>
            <td>
              <i class="chart-legend-color nxg-chart-available-credit"></i>
            </td>
            <td class="table-label">Available Credit</td>
            <td class="table-symbol">=</td>
            <td class="table-value table-numeric">{{ dashboardData.AvailableCredit | numeral:'$0,0.00' }}</td>
          </tr>
        </table>
      </div>

      <button class="btn-cta cta-full cta-secondary" href="javascript:void(0)" ng-click="onRequestCredIncr()" nxg-track="{{metric.CLICK_DASHBOARD_REQUEST_CREDIT_INCREASE_BUTTON}}">
        <span class="paired-body">Request Credit Increase</span>
        <span class="paired-media icon-x-small" nxg-icon="icon-triangle"></span>
      </button>
    </div>
  </div>

  <!-- Receipts Summary -->
  <div class="span4 well">
    <h2 class="well-title">Recent Receipts</h2>
    <table class="table table-striped table-secondary">
      <thead>
        <th>Receipt Date</th>
        <th>Receipt No.</th>
        <th>Amount</th>
      </thead>
      <tr ng-repeat="receipt in dashboardData.Receipts">
        <td class="table-label">{{ receipt.ReceiptDate | moment }}</td>
        <td class="table-value center"><a ng-href="{{ receipt.$receiptURL }}" target="_blank" nxg-track="{{metric.CLICK_DASHBOARD_VIEW_RECEIPTS}}">#{{ receipt.ReceiptNumber }}</a></td>
        <td class="table-value table-numeric">{{ receipt.ReceiptAmount | currency }}</td>
      </tr>
    </table>
    <button class="btn-cta cta-full cta-secondary" href="#/home/receipts" nxg-track="{{metric.CLICK_DASHBOARD_VIEW_ALL_RECEIPTS}}">
      <span class="paired-body">View All Receipts</span>
      <span class="paired-media icon-x-small" nxg-icon="icon-triangle"></span>
    </button>
  </div>

  <!-- Unapplied Funds Summary -->
  <div nxg-unapplied-funds-widget
       balance="dashboardData.UnappliedFundsTotal"
       available="dashboardData.TotalAvailableUnappliedFunds">
  </div>
</section>

<section class="row-fluid">
  <!-- Floor Plan Summary -->
  <div class="span2 well ">
    <h2 class="well-title">Floor Plan</h2>
    <ul>
      <li class="row-fluid">
        <div class="span6">
          <span class="counter">
            {{ dashboardData.ApprovedFloorplans | alt }}
          </span>
        </div>
        <div class="span6 counter-label">
          <span tooltip="This status applies to vehicles floored via NextGearCapital.com or by a NextGear employee via NextGear's Discover system that have been approved and are currently on the NextGear dealer's floor plan."
            tooltip-placement="right"
            tooltip-popup-delay="700">
              Approved
          </span>
        </div>
      </li>

      <li class="row-fluid">
        <div class="span6">
          <span class="counter">
            {{ dashboardData.PendingFloorplans | alt }}
          </span>
        </div>
        <div class="span6 counter-label">
          <span tooltip="This status applies to vehicles floored via NextGearCapital.com or by a NextGear employee via NextGear's Discover system that have not yet been approved by a NextGear employee."
            tooltip-placement="right"
            tooltip-popup-delay="700">
              Pending
          </span>
        </div>
      </li>

      <li class="row-fluid">
        <div class="span6">
          <span class="counter">
            {{ dashboardData.DeniedFloorplans | alt }}
          </span>
        </div>
        <div class="span6 counter-label">
          <span tooltip="This status applies to vehicles floored via NextGearCapital.com that have been denied by a NextGear employee. Please contact NextGear Customer Service to find out why a vehicle has been denied."
            tooltip-placement="right"
            tooltip-popup-delay="700">
              Denied
          </span>
        </div>
      </li>
    </ul>

    <table>
      <tr class="more" href="#/home/floorplan?filter=approved">
        <!-- <td>
          <span class="counter">
            {{ dashboardData.ApprovedFloorplans | alt }}
          </span>
        </td>
        <td class="fl-label">
          <span tooltip="This status applies to vehicles floored via NextGearCapital.com or by a NextGear employee via NextGear's Discover system that have been approved and are currently on the NextGear dealer's floor plan."
            tooltip-placement="right"
            tooltip-popup-delay="700">
              Approved
          </span>
        </td> -->
      </tr>

      <tr class="more" href="#/home/floorplan?filter=pending">
       <!--  <td>
          <span class="counter">
            {{ dashboardData.PendingFloorplans | alt }}
          </span>
        </td>
        <td class="fl-label">
          <span tooltip="This status applies to vehicles floored via NextGearCapital.com or by a NextGear employee via NextGear's Discover system that have not yet been approved by a NextGear employee."
            tooltip-placement="right"
            tooltip-popup-delay="700">
              Pending
          </span>
        </td> -->
      </tr>

      <tr class="more" href="#/home/floorplan?filter=denied">
        <!-- <td>
          <span class="counter">
            {{ dashboardData.DeniedFloorplans | alt }}
          </span>
        </td>
        <td class="fl-label">
          <span tooltip="This status applies to vehicles floored via NextGearCapital.com that have been denied by a NextGear employee. Please contact NextGear Customer Service to find out why a vehicle has been denied."
            tooltip-placement="right"
            tooltip-popup-delay="700">
              Denied
          </span>
        </td> -->
      </tr>
    </table>
    <button class="btn-cta cta-full cta-secondary" href="#/home/floorplan" nxg-track="{{metric.CLICK_DASHBOARD_VIEW_FLOORPLAN_BUTTON}}">
      <span class="paired-body">View Floorplan</span>
      <span class="paired-media icon-x-small" nxg-icon="icon-triangle"></span>
    </button>
  </div><!-- end .summary.floorplan -->

  <div class="span10 well">
    <h2 class="well-title">Recently Floored Vehicles</h2>
  </div>
</section>
