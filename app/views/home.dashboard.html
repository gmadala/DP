<section class="row-fluid upcoming">
    <h4 class="row-item">Upcoming Payments</h4>
    <select class="row-item" name="viewMode" ng-model="viewMode">
        <option value="week">This Week</option>
        <option value="month">This Month</option>
    </select>
    <div class="row-fluid basic">
        <div class="span8" nxg-upcoming-calendar display="viewMode"></div>
        <div class="span4">
            <ul>
                <li>
                    <a class="more" href="#/home/payments">
                        <span class="item-total">{{paymentSummary.overdue.quantity}}</span>
                        <span ng-pluralize count="paymentSummary.overdue.quantity" when="{'1': 'OVERDUE Payment', 'other': 'OVERDUE Payments'}"></span>
                        <span> - {{paymentSummary.overdue.amount | currency}}</span>
                        <i class="icon-arrow-right"></i>
                    </a>
                </li>
                <li>
                    <a class="more" href="#/home/payments">
                        <span class="item-total">{{paymentSummary.dueToday.quantity}}</span>
                        <span ng-pluralize count="paymentSummary.dueToday.quantity" when="{'1': 'Payment DUE TODAY', 'other': 'Payments DUE TODAY'}"></span>
                        <span> - {{paymentSummary.dueToday.amount | currency}}</span>
                        <i class="icon-arrow-right"></i>
                    </a>
                </li>
                <li>
                    <a class="more" href="#/home/payments">
                        <span class="item-total">{{paymentSummary.thisWeek.quantity}}</span>
                        <span ng-pluralize count="paymentSummary.thisWeek.quantity" when="{'1': 'Payment THIS WEEK', 'other': 'Payments THIS WEEK'}"></span>
                        <span> - {{paymentSummary.thisWeek.amount | currency}}</span>
                        <i class="icon-arrow-right"></i>
                    </a>
                </li>
                <li>
                    <a class="more" href="#/home/payments">
                        <span class="item-total">{{paymentSummary.accountFees.quantity}}</span>
                        <span ng-pluralize count="paymentSummary.accountFees.quantity" when="{'1': 'Account Fee', 'other': 'Account Fees'}"></span>
                        <span> - {{paymentSummary.accountFees.amount | currency}}</span>
                        <i class="icon-arrow-right"></i>
                    </a>
                </li>
                <li>
                    <a class="more" href="#/home/payments">
                        View All Payments
                        <i class="icon-arrow-right"></i>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <btn ng-click="isCollapsed = !isCollapsed" class="more btn btn-mini">More Details</btn>
    <div collapse="isCollapsed" class="row-fluid more-details">
        <div class="span8">
            <h4>Upcoming Payments</h4>
            <table>
                <thead>
                <tr>
                    <th>Due Date</th>
                    <th>Description</th>
                    <th>Payoff Due</th>
                    <th>Payment Due</th>
                </tr>
                </thead>
                <tr ng-repeat="payment in upcomingPayments">
                    <td title="Due Date">{{ payment.DueDate | date:'shortDate'  }}</td>
                    <td title="Description">{{ payment.UnitDescription }}</td>
                    <td title="Payoff Due"><span ng-show="payment.IsPayoff">{{ payment.PrincipalPayoff | currency }}</span></td>
                    <td title="Payment Due"><span ng-show="!payment.IsPayoff">{{ payment.AmountDue | currency }}</span></td>
                </tr>
            </table>
            <tfoot>
            <a class="more" href="#/home/payments">View All Payments <i class="icon-arrow-right"></i></a>
            </tfoot>
        </div>
        <div class="span4 graphic">
            <canvas width="100"
                    height="100"
                    nxg-chart
                    nxg-chart-type="Pie"
                    nxg-chart-data="paymentSummary.chartData">
            </canvas>
            <ul>
                <li>Fees: {{paymentSummary.chartData[0].value | currency}}</li>
                <li>Payments: {{paymentSummary.chartData[1].value | currency}}</li>
                <li>Scheduled Payments: {{paymentSummary.chartData[2].value | currency}}</li>
                <li>Total for this week: {{paymentSummary.chartData[0].value + paymentSummary.chartData[1].value + paymentSummary.chartData[2].value | currency}}</li>
            </ul>
        </div>
    </div>
</section>

<section class="row-fluid summaries">
    <div class="span4 summary credit">
        <h3>Credit</h3>

        <table class="credit-summary-table">
            <tr>
                <td><i class="nxg-chart-legend-color nxg-chart-approved-credit"></i></td>
                <td>Line of Credit</td>
                <td>+ {{credit.lineOfCredit | numeral:'$0,0'}}</td>
            </tr>
            <tr class="credit-summary-table-total-row">
                <td><i class="nxg-chart-legend-color nxg-chart-temporary-credit"></i></td>
                <td>Temp Line of Credit</td>
                <td>+ {{credit.tempLineOfCredit | numeral:'$0,0'}}</td>
            </tr>
            <tr>
                <td></td>
                <td>Total Credit</td>
                <td>= {{credit.totalCredit | numeral:'$0,0'}}</td>
            </tr>
            <tr class="credit-summary-table-total-row">
                <td><i class="nxg-chart-legend-color nxg-chart-utilized-credit"></i></td>
                <td>Utilized Credit</td>
                <td>- {{credit.utilizedCredit | numeral:'$0,0'}}</td>
            </tr>
            <tr>
                <td><i class="nxg-chart-legend-color nxg-chart-available-credit"></i></td>
                <td>Available Credit</td>
                <td>= {{credit.availableCredit | numeral:'$0,0'}}</td>
            </tr>
        </table>

        <div class="nxg-doughnut-chart-nested">
            <canvas width="110"
                    height="110"
                    class="nxg-doughnut-chart-outer"
                    nxg-chart
                    nxg-chart-type="Doughnut"
                    nxg-chart-data="credit.chartData.outer"
                    nxg-chart-options="{percentageInnerCutout: 77}">
            </canvas>
            <canvas width="90"
                    height="90"
                    class="nxg-doughnut-chart-inner"
                    nxg-chart
                    nxg-chart-type="Doughnut"
                    nxg-chart-data="credit.chartData.inner"
                    nxg-chart-options="{percentageInnerCutout: 85}">
            </canvas>
            <label class="nxg-doughnut-chart-label">
                <p class="nxg-doughnut-chart-label-primary">{{credit.availableCredit | numeral:'($0a)'}}</p>
                <p class="nxg-doughnut-chart-label-secondary">of {{credit.totalCredit | numeral:'($0a)'}}</p>
            </label>
        </div>

    </div>
    <div nxg-unapplied-funds-widget></div>
    <div class="span2 summary floorplan">
        <h3>Floorplan</h3>
        <ul>
            <li>
                <a class="more" href="#/home/floorplan?filter=approved"
                   tooltip="This status applies to vehicles floored via NextGearCapital.com
                     or by a NextGear employee via NextGear's Discover system that have been approved
                      and are currently on the NextGear dealers floorplan."
                   tooltip-placement="right"
                   tooltip-popup-delay="700">
                    <span class="item-total">{{ floorplanSummary.approved | alt }}</span>
                    <span>Approved</span>
                </a>
            </li>
            <li>
                <a class="more" href="#/home/floorplan?filter=pending"
                   tooltip="This status applies to vehicles floored via NextGearCapital.com
                    or by a NextGear employee via NextGear's Discover system that have not yet been
                    approved by a NextGear employee."
                   tooltip-placement="right"
                   tooltip-popup-delay="700">
                    <span class="item-total">{{ floorplanSummary.pending | alt }}</span>
                    <span>Pending</span>
                </a>
            </li>
            <li>
                <a class="more" href="#/home/floorplan?filter=denied"
                   tooltip="This status applies to vehicles floored via NextGearCapital.com
                    that have been denied by a NextGear employee. Please contact NextGear Customer
                    Service to find out why a vehicle has been denied."
                   tooltip-placement="right"
                   tooltip-popup-delay="700">
                    <span class="item-total">{{ floorplanSummary.denied | alt }}</span>
                    <span>Denied</span>
                </a>
            </li>
        </ul>
        <a class="more" href="#/home/floorplan">View Floorplan<i class="icon-arrow-right"></i></a>
    </div>
    <div class="span3 summary receipts">
        <h3>Most Recent Receipts</h3>
        <table>
            <tr ng-repeat="receipt in recentReceipts">
                <td>{{ receipt.CreateDate * 1000 | date:'shortDate' }}</td>
                <td>#{{ receipt.TransactionNumber }}</td>
                <td>{{ receipt.AmountProvided | currency }}</td>
                <td><a ng-href="#/home/receipts?search={{ receipt.TransactionNumber }}">View</a></td>
            </tr>
        </table>
        <a class="more" href="#/home/receipts">View All Receipts<i class="icon-arrow-right"></i></a>
    </div>
</section>
